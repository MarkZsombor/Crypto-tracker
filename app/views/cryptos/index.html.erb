<h1>Crypto Portfolio</h1>
<%= link_to 'Add Crypto', new_crypto_path %>
<table>
  <tr>
    <th>Crypto</th>
    <th>Amount</th>
    <th>BTC Value</th>
    <th>USD Value</th>
  </tr>

  <% total_btc_value = 0 %>
  <% total_fiat_value = 0 %>

  <% @cryptos.each do |crypto| %>
    <% btc_value = (get_crypto_info("#{crypto.crypto}")[0]["price_btc"].to_f * crypto.amount).round(5) %>
    <% total_btc_value += btc_value %>

    <% fiat_value = (get_crypto_info("#{crypto.crypto}")[0]["price_usd"].to_f * crypto.amount).round(2) %>
    <% total_fiat_value += fiat_value %>

    <tr>
      <td><%= crypto.crypto %></td>
      <td><%= crypto.amount %></td>
      <td><%= "₿ #{btc_value}" %></td>
      <td><%= "$ #{fiat_value}" %></td>
      <td><%= link_to 'Details', crypto_path(crypto) %></td>
      <td><%= link_to 'Update', edit_crypto_path(crypto) %></td>
      <td><%= link_to 'Remove', crypto_path(crypto),
              method: :delete,
              data: { confirm: 'Are you sure you want to abandon your precious crypto?' } %></td>
    </tr>
  <% end %>
  <tr><!-- Empty Row--></tr>
  <tr>
    <td><strong>Total:</strong></td>
    <td><!-- Empty Data--></td>
    <td><strong><%= "₿ #{total_btc_value.round(2)}" %></strong></td>
    <td><strong><%= "$ #{total_fiat_value.round(2)}" %></strong></td>
  </tr>
</table>